\chapter{Summary Generation\label{chap:summary-generation}}
  A process to extract and refine a list of points could be used in a number of ways. From this foundation, we investigate a potential use for points in a summarization task. Extracted points are short and have a `pattern' that allows for new comparisons not possible with plain text extracts. This chapter first explains a number of shared components used in building each summary section, then goes on to describe each section in detail.

  \section{Permitted Extracts}
    In a cluster of points with the same patter there are a range of different extracts that could be selected. There is much variation in quality caused by additional words, bad parses and poor punctuation. Removing points with extracts that matched heuristics for poor quality would significantly reduce the information available to determine a cluster's salience. Such points are useful in aggregation but not for presentation.

    Instead we implemented a set of rules that prevent a point's extract from being used in the summary, even while the point itself remains in the cluster to aid aggregation and sorting tasks.

    Predominantly exclusions are made based on the presence of certain substrings using regular expressions. Exclusion patterns include: starts with a wh-question word or contains a question mark; has two or more consecutive words in block capitals or contains a mid-word case change. Since these patterns can be applied very quickly extracts are tested using these first.

    Following on from these, there are other more complex exclusion patterns based on the dependencies from re-parsing the extract using CoreNLP. Extracts with clausal or generic dependencies are excluded, such dependencies are characteristic of long points or erroneous parses. An extract may also be excluded if it contains more than two conjunctive relations or nominal dependencies.

    Finally some additional restrictions, that are not based on the dependencies or the strings, are applied. For example, an `it' must be preceded by \{on, and, but, whether\} and words are not allowed to be repeated.

  \section{Extract Selection}
    Points are manipulated in clusters where members share a common pattern, for example, there might be a cluster where each point had the pattern \texttt{woman.nsubj make.verb choice.dobj}. This cluster would contain all the points with this pattern and in turn all the extracts that could be used in a summary to express this point. Even after refining the list of points input to this component of the pipeline there is much variation in the quality of the extracts available for selection. Take this example cluster of extracts for points about the Genesis creation narrative:

    \begin{itemize}[label={}]
      \item{\blockquote{The world was created in six days.}}
      \item{\blockquote{The world was created in exactly 6 days.}}
      \item{\blockquote{Is there that the world could have been created in six days.}}
      \item{\blockquote{The world was created by God in seven days.}}
      \item{\blockquote{The world was created in 6 days.}}
      \item{\blockquote{But, was the world created in six days.}}
      \item{\blockquote{How the world was created in six days.}}
    \end{itemize}

    All of these passed the `Permitted Extracts' stage. The task is to select the best extract to represent the cluster. In this instance our approach selected the fifth point, \blockquote{The world was created in 6 days.}. This selection is made every time a cluster has been selected for use in a summary as an extract to represent it is required. This is done using a bag-of-words, length-weighted, bigram model of the extract words in the cluster. The goal was to select the most succinct extract that was most representative of the pattern cluster.

    Extracts are iterated and the bigrams for each collected. Bigrams are given a value equal to the number of times they occur in the cluster. Each extract is then given a value equal to the sum of the values for the bigrams it contains. This extract value is then divided by the number of words in the extract to determine a final score. The extract with the highest score is selected for use in the summary.

  \section{Extract Presentation \& Formatting}
    Our points extraction approach works by selecting the relevant components in a string for a given point, using the dependency parse graph. While this has a key advantage in creating shorter content units, it also means that extracts are often poorly formatted for presentation in isolation. To overcome this we needed to implement a means of correcting extracts for presentation, below are two examples that illustrate the problem with poor punctuation and style.

    \blockquote{that Scientifically , human life begins at this stage}
    and
    \blockquote{.that a fetus is a person ,}

    To overcome this we have a short function to ensure the extract meets the following properties: extract is capitalized; ends in a period; commas are not preceded by a space; contractions are applied where possible and consecutive punctuation marks condensed or removed. Certain determiners, adverbs and conjunctions (because, that, therefore) are also removed removed from \textit{the start} of extracts. The two extracts above are translated into the following cleaner versions:

    \blockquote{Scientifically, human life begins at this stage.}
    and
    \blockquote{A fetus is a person.}

    This particular feature still requires work. The task of correctly formatting a string has only been touched on here and is a candidate for further work on the project.

  \section{Avoiding Repetition in Summaries}
    A cluster's inclusion in a particular summary section is a function of the number of points in the cluster. This is based on the idea that larger clusters are have greater importance and should the highest priority to include in the summary. To avoid large clusters being repeatedly selected at each summary section, a list of used patterns and extracts is maintained.

    When an extract is used in a summary section it is `spent', and added to a list of used extracts. The extract pattern, string, lemmas and subject-verb-object triple are added to this list. Any point that matches anything in this list of used identifiers cannot be used. The same extract may be included in many clusters under different point patterns. For example, \blockquote{Life begins at conception.} is matched by both the \texttt{life.nsubj begins.verb} and \texttt{life.nsubj begins.verb at.prep conception.dobj} patterns. This means that when checking is an extract is suitable it must be checked against the text \textit{and} patterns of those already used.

    \tocless\subsection{Negation Shorthand}
      As part of the counter point analysis discussed in the following section, a condensed point representation was developed for expressing points that shared many of the same words. For example, to include both \blockquote{A fetus is a human} as well as \blockquote{A fetus is \textbf{not} a human} is a highly repetitive presentation. Such a presentation does not make for good reading and uses words that could be used to express additional information from another point.

      Based largely on a string diffing library\footnote{https://rubygems.org/gems/differ}, we developed an alternative, more condensed presentation for such pairs of points. Under this, the above examples could be written as \blockquote{A fetus is \textbf{\{}not\textbf{\}} a human}, saving five repeated words. However, more complex examples also occurred such as \blockquote{Abortion \textbf{\{}is not\textbf{|}should be\textbf{\}} legal \textbf{\{}after 12 weeks\textbf{\}}} (\blockquote{Abortion should be legal} and \blockquote{abortion is not legal after 12 weeks}). While there are adjustments that can be made to improve this, such as requiring the two extracts to have a similar number of words, complex examples still surfaced and the formatting was not used.

      The diffing functionality is still used in the identification of counter points.

  \section{Summary Sections}
    \subsection{Counter Points}
      The identification of counter points were a goal for the project from the start. Counter points are matched on one of two possible criteria, either the presence of negation terminology or a antonym for a work that is part of the point's pattern.

      Potential, antonym-derived counter points, for a given point, are generated using it's pattern. Taking the pattern \texttt{treatment.nsubj be.verb private.dobj} as an example, this generates the counter point \texttt{treatment.nsubj be.verb \textbf{public}.dobj}. These substitutions can be applied to any component that has an antonym, including verbs (\texttt{sperm.nsubj have.verbs rights.dobj} vs \texttt{sperm.nsubj \textbf{lack.verb} rights.dobj}). If there are many words in the pattern with antonym matches then multiple potential counter points are generated for a single point.

      Once a list of potential point vs. counter point patterns has been generated these are filtered to make sure that both the generated counter point pattern exists in the list of points and that the there are no duplicate pairs. A point/counter point pair cannot also appear in in reverse as part of another pair.

      Counter points are selected for display based on the average size of the clusters for the point and counter point. This is intended to represent ``the most common pairs of contradictory points''. In the summary text only the extract for the point is displayed, not the counter. The section is introduced as ``points that people disagree on'' so stating either point presents it as a point that is contested. Previously the `negation shorthand' was used to present points and counter points but variation in extracts often led to complex examples.

    \subsection{Negated Points}
      Negated points are displayed in the same summary section, `points that people disagree on'', however they are identified differently. Negated points are selected from the largest unused clusters. Negation terminology is not commonly part of the cluster pattern, for example, the \texttt{woman.nsubj have.verb right.dobj} cluster could include both \blockquote{A woman has the right} and \blockquote{The woman does not have the right} as extracts. Identifying these negated forms within clusters is how negation-derived counter points are collected.

      First the cluster is split into two groups, extracts with negation terminology and those without. The Cartesian product of these two groups gives all pairs of negated and non-negated extracts. For each of these pairs; a string difference is computed\footnote{https://rubygems.org/gems/differ}, the complexity of this difference pattern is used to identify a clean match. For example \blockquote{\{+that \}a fetus is \{-not \}a person\{- under the law of the eu\}} is not as clean as \blockquote{that a fetus is\{n't \}a person}. By counting elements in the difference pattern we are able to select shorter and cleaner examples where they exist.

      However, similarly to antonym-derived counter points, clean examples do not always exist. Negated points are represented as the positive side extract of the pair and listed under the ``points that people disagree on'' section.

    \subsection{Co-occurring Points}
    \subsection{Commonly Occurring Points}
    \subsection{Longer Pattern Points}
    \subsection{Topic Points}
    \subsection{Topic Linking Points}
    \subsection{Questions}
